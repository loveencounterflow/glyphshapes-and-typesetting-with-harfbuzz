{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/demo-harfbuzz.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n'use strict'\n\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'DEMO-HARFBUZZ'\ndebug                     = CND.get_logger 'debug',     badge\nalert                     = CND.get_logger 'alert',     badge\nwhisper                   = CND.get_logger 'whisper',   badge\nwarn                      = CND.get_logger 'warn',      badge\nhelp                      = CND.get_logger 'help',      badge\nurge                      = CND.get_logger 'urge',      badge\ninfo                      = CND.get_logger 'info',      badge\necho                      = CND.echo.bind CND\n#...........................................................................................................\nFS                        = require 'fs'\nPATH                      = require 'path'\nSEMVER                    = require 'semver'\nSHELL                     = require 'shelljs'\nSP                        = require 'steampipes'\n{ $\n  $async\n  $watch\n  $show\n  $drain }                = SP.export()\nDATOM                     = require 'datom'\n{ new_datom\n  freeze    }             = DATOM.export()\n{ spawn }                 = require 'child_process'\n\n\n#-----------------------------------------------------------------------------------------------------------\ndefaults =\n  verbose: true\n  shell:\n    verbose: false\n  harfbuzz:\n    semver: '^2.7.4'\n\n#-----------------------------------------------------------------------------------------------------------\n@_show_shell_output = ( output ) ->\n  echo()\n  help '^demo-harfbuzz@87^ stdout:', ( rpr output.stdout ) if output.stdout? and output.stdout.length > 0\n  warn '^demo-harfbuzz@87^ stderr:', ( rpr output.stderr ) if output.stderr? and output.stderr.length > 0\n  echo()\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@ensure_harfbuzz_version = ->\n  cmds = [\n    'hb-shape'\n    'hb-view' ]\n  #.........................................................................................................\n  for cmd in cmds\n    output = SHELL.exec \"#{cmd} --version\", { silent: ( not defaults.shell.verbose ), }\n    #.......................................................................................................\n    unless output.code is 0\n      @_show_shell_output output\n      throw new Error \"^demo-harfbuzz@87^ ensure that harfbuzz is available on the path (recommendation: `homebrew install harfbuzz` on Linux, Mac)\"\n    pattern = /// ^ #{cmd} \\s+ \\(HarfBuzz\\) \\s+ (?<version>[0-9a-z.]+) \\n ///\n    #.......................................................................................................\n    unless ( match = output.stdout.match pattern )?\n      @_show_shell_output output\n      throw new Error \"^demo-harfbuzz@87^ ensure that harfbuzz is available on the path (recommendation: `homebrew install harfbuzz` on Linux, Mac)\"\n    #.......................................................................................................\n    unless SEMVER.satisfies match.groups.version, defaults.harfbuzz.semver\n      @_show_shell_output output\n      throw new Error \"^demo-harfbuzz@87^ found HarfBuzz #{rpr cmd} version #{rpr match.groups.version}, expected #{rpr defaults.harfbuzz.semver}\"\n    #.......................................................................................................\n    whisper \"^33787^ #{cmd} version #{match.groups.version} OK\" if defaults.verbose\n  #.........................................................................................................\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@$extract_hbshape_positioning = ( S ) ->\n  return $ ( d, send ) ->\n    return null unless d.$key is '^stdout'\n    return null unless d.$value?\n    return null unless ( match = d.$value.match /^(?<lnr>[0-9]+):\\s+(?<positions>\\[.*\\])$/ )?\n    send JSON.parse match.groups.positions\n\n\n#-----------------------------------------------------------------------------------------------------------\n### TAINT add styling, font features ###\n@shape_text = ( font_path, text ) -> new Promise ( resolve, reject ) =>\n  #.........................................................................................................\n  parameters    = [\n    '--output-format=json'\n    '--show-extents'\n    '--show-flags'\n    '--verbose'\n    font_path\n    text              ]\n  #.........................................................................................................\n  cp              = spawn 'hb-shape', parameters\n  stream_settings = { bare: true, }\n  source          = SP.source_from_child_process cp, stream_settings\n  S               = freeze { font_path, text, }\n  pipeline        = []\n  pipeline.push source\n  pipeline.push SP.$split_channels()\n  pipeline.push @$extract_hbshape_positioning S\n  pipeline.push $show()\n  pipeline.push $drain -> urge \"shape_text finished\"; resolve()\n  SP.pull pipeline...\n  #.........................................................................................................\n  return null\n\n\n\n############################################################################################################\nif module is require.main then do =>\n  HB = @\n  HB.ensure_harfbuzz_version()\n  font_path = 'EBGaramond12-Italic.otf'\n  font_path = PATH.resolve PATH.join __dirname, '../fonts', font_path\n  text      = \"glyph ffi shaping\\nagffixè°·\"\n  await HB.shape_text font_path, text\n  # debug '^445^', ( k for k of SP ).sort()\n\n"
  ]
}